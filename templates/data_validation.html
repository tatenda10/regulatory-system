{% extends "base.html" %}
{% load static %}

{% block title %}Data & Validation - IPEC{% endblock %}

{% block content %}
<div class="p-4 sm:p-6">
    <!-- Page Header -->
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-2">Data & Validation</h1>
        <p class="text-gray-600">Submission History and Data Quality Management</p>
    </div>

    <!-- Summary Cards -->
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
            <div class="flex items-center">
                <div class="p-2 bg-blue-100 rounded-md">
                    <i data-lucide="upload" class="w-4 h-4 text-blue-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-gray-600">Total Submissions</p>
                    <p class="text-lg font-semibold text-gray-900">247</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
            <div class="flex items-center">
                <div class="p-2 bg-green-100 rounded-md">
                    <i data-lucide="check-circle" class="w-4 h-4 text-green-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-gray-600">Successful</p>
                    <p class="text-lg font-semibold text-gray-900">231</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
            <div class="flex items-center">
                <div class="p-2 bg-red-100 rounded-md">
                    <i data-lucide="x-circle" class="w-4 h-4 text-red-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-gray-600">Failed</p>
                    <p class="text-lg font-semibold text-gray-900">16</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
            <div class="flex items-center">
                <div class="p-2 bg-yellow-100 rounded-md">
                    <i data-lucide="alert-triangle" class="w-4 h-4 text-yellow-600"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-gray-600">Validation Errors</p>
                    <p class="text-lg font-semibold text-gray-900">23</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        
        <!-- Submission History -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <div class="flex items-center mb-4">
                <i data-lucide="file-text" class="w-5 h-5 text-blue-600 mr-2"></i>
                <h2 class="text-lg font-semibold text-gray-900">Submission History</h2>
            </div>
            
            <div class="space-y-4">
                <!-- Recent Submissions -->
                <div class="space-y-3">
                    <h4 class="font-medium text-gray-900">Recent Submissions</h4>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md">
                            <div class="flex items-center">
                                <i data-lucide="file" class="w-4 h-4 text-green-600 mr-2"></i>
                                <div>
                                    <div class="text-sm font-medium text-green-900">Q3_2024_Solvency_Report.xbrl</div>
                                    <div class="text-xs text-green-700">Submitted: 15 Nov 2024 • 2.3 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Success</span>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-md">
                            <div class="flex items-center">
                                <i data-lucide="file" class="w-4 h-4 text-green-600 mr-2"></i>
                                <div>
                                    <div class="text-sm font-medium text-green-900">Monthly_Risk_Dashboard.xml</div>
                                    <div class="text-xs text-green-700">Submitted: 5 Dec 2024 • 1.8 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Success</span>
                        </div>
                        
                        <div class="flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-md">
                            <div class="flex items-center">
                                <i data-lucide="file" class="w-4 h-4 text-red-600 mr-2"></i>
                                <div>
                                    <div class="text-sm font-medium text-red-900">IFRS17_Quarterly_Update.csv</div>
                                    <div class="text-xs text-red-700">Submitted: 10 Dec 2024 • 0.9 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">Failed</span>
                        </div>
                    </div>
                </div>

                <!-- File Type Breakdown -->
                <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
                    <h4 class="font-medium text-blue-900 mb-3">File Type Breakdown</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span class="text-blue-700">XBRL Files</span>
                            <span class="font-medium text-blue-900">156 (63%)</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-blue-700">XML Files</span>
                            <span class="font-medium text-blue-900">67 (27%)</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-blue-700">CSV Files</span>
                            <span class="font-medium text-blue-900">24 (10%)</span>
                        </div>
                    </div>
                </div>

                <!-- Submission Statistics -->
                <div class="bg-gray-50 border border-gray-200 rounded-md p-4">
                    <h4 class="font-medium text-gray-900 mb-2">Submission Statistics</h4>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div class="text-center">
                            <div class="text-lg font-bold text-green-600">93.5%</div>
                            <div class="text-gray-600">Success Rate</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-blue-600">2.1 MB</div>
                            <div class="text-gray-600">Avg File Size</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Validation Errors -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
            <div class="flex items-center mb-4">
                <i data-lucide="alert-triangle" class="w-5 h-5 text-red-600 mr-2"></i>
                <h2 class="text-lg font-semibold text-gray-900">Validation Errors</h2>
            </div>
            
            <div class="space-y-4">
                <!-- Coverage Units vs CSM Release -->
                <div class="bg-red-50 border border-red-200 rounded-md p-4">
                    <h4 class="font-medium text-red-900 mb-3">Coverage Units vs CSM Release</h4>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-sm font-medium text-red-900">Life Insurance Group A</div>
                                <div class="text-xs text-red-700">Coverage Units: 1,250 vs CSM Release: 1,180</div>
                            </div>
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">Error</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-sm font-medium text-red-900">Health Insurance Group B</div>
                                <div class="text-xs text-red-700">Coverage Units: 890 vs CSM Release: 920</div>
                            </div>
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">Error</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="text-sm font-medium text-red-900">Annuity Group C</div>
                                <div class="text-xs text-red-700">Coverage Units: 450 vs CSM Release: 450</div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Valid</span>
                        </div>
                    </div>
                </div>

                <!-- Reconciliation Errors -->
                <div class="bg-yellow-50 border border-yellow-200 rounded-md p-4">
                    <h4 class="font-medium text-yellow-900 mb-3">Reconciliation Errors</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span class="text-yellow-700">Balance Sheet Reconciliation</span>
                            <span class="font-medium text-yellow-900">€-15,000</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-yellow-700">P&L Reconciliation</span>
                            <span class="font-medium text-yellow-900">€+8,500</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-yellow-700">Cash Flow Reconciliation</span>
                            <span class="font-medium text-yellow-900">€-2,300</span>
                        </div>
                    </div>
                </div>

                <!-- Data Quality Issues -->
                <div class="bg-orange-50 border border-orange-200 rounded-md p-4">
                    <h4 class="font-medium text-orange-900 mb-3">Data Quality Issues</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between text-sm">
                            <span class="text-orange-700">Missing Data Points</span>
                            <span class="font-medium text-orange-900">12</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-orange-700">Format Errors</span>
                            <span class="font-medium text-orange-900">8</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-orange-700">Validation Failures</span>
                            <span class="font-medium text-orange-900">3</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Audit Trail -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 lg:col-span-2">
            <div class="flex items-center mb-4">
                <i data-lucide="history" class="w-5 h-5 text-purple-600 mr-2"></i>
                <h2 class="text-lg font-semibold text-gray-900">Audit Trail</h2>
            </div>
            
            <div class="space-y-4">
                <!-- Recent Activities -->
                <div class="bg-purple-50 border border-purple-200 rounded-md p-4">
                    <h4 class="font-medium text-purple-900 mb-3">Recent Activities</h4>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3">
                                    <i data-lucide="user" class="w-4 h-4 text-blue-600"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-purple-900">John Smith submitted Q3 Solvency Report</div>
                                    <div class="text-xs text-purple-700">15 Nov 2024, 14:32 • XBRL • 2.3 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Success</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                    <i data-lucide="user" class="w-4 h-4 text-green-600"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-purple-900">Sarah Johnson validated Risk Dashboard</div>
                                    <div class="text-xs text-purple-700">5 Dec 2024, 09:15 • XML • 1.8 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Success</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center mr-3">
                                    <i data-lucide="user" class="w-4 h-4 text-red-600"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-purple-900">Mike Wilson attempted IFRS17 Update</div>
                                    <div class="text-xs text-purple-700">10 Dec 2024, 16:45 • CSV • 0.9 MB</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">Failed</span>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mr-3">
                                    <i data-lucide="user" class="w-4 h-4 text-yellow-600"></i>
                                </div>
                                <div>
                                    <div class="text-sm font-medium text-purple-900">Lisa Brown reviewed validation errors</div>
                                    <div class="text-xs text-purple-700">11 Dec 2024, 11:20 • System Action</div>
                                </div>
                            </div>
                            <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Review</span>
                        </div>
                    </div>
                </div>

                <!-- User Activity Summary -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
                        <h4 class="font-medium text-blue-900 mb-2">Most Active Users</h4>
                        <div class="space-y-1 text-sm">
                            <div class="flex justify-between">
                                <span class="text-blue-700">John Smith</span>
                                <span class="font-medium text-blue-900">45 submissions</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-blue-700">Sarah Johnson</span>
                                <span class="font-medium text-blue-900">38 submissions</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-blue-700">Mike Wilson</span>
                                <span class="font-medium text-blue-900">32 submissions</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 border border-green-200 rounded-md p-4">
                        <h4 class="font-medium text-green-900 mb-2">Submission Times</h4>
                        <div class="space-y-1 text-sm">
                            <div class="flex justify-between">
                                <span class="text-green-700">Peak Hours</span>
                                <span class="font-medium text-green-900">9-11 AM</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-green-700">Avg Processing</span>
                                <span class="font-medium text-green-900">2.3 min</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-green-700">Success Rate</span>
                                <span class="font-medium text-green-900">93.5%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-purple-50 border border-purple-200 rounded-md p-4">
                        <h4 class="font-medium text-purple-900 mb-2">System Metrics</h4>
                        <div class="space-y-1 text-sm">
                            <div class="flex justify-between">
                                <span class="text-purple-700">Total Files</span>
                                <span class="font-medium text-purple-900">247</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-purple-700">Total Size</span>
                                <span class="font-medium text-purple-900">518 MB</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-purple-700">Last 30 Days</span>
                                <span class="font-medium text-purple-900">23 files</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Quality Dashboard -->
    <div class="mt-6 bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <div class="flex items-center mb-4">
            <i data-lucide="shield-check" class="w-5 h-5 text-gray-600 mr-2"></i>
            <h2 class="text-lg font-semibold text-gray-900">Data Quality Dashboard</h2>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="bg-green-50 border border-green-200 rounded-md p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-green-600">Data Completeness</p>
                        <p class="text-2xl font-bold text-green-700">94.2%</p>
                    </div>
                    <i data-lucide="check-circle" class="w-8 h-8 text-green-600"></i>
                </div>
            </div>
            
            <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-blue-600">Data Accuracy</p>
                        <p class="text-2xl font-bold text-blue-700">91.8%</p>
                    </div>
                    <i data-lucide="target" class="w-8 h-8 text-blue-600"></i>
                </div>
            </div>
            
            <div class="bg-yellow-50 border border-yellow-200 rounded-md p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-yellow-600">Data Consistency</p>
                        <p class="text-2xl font-bold text-yellow-700">88.5%</p>
                    </div>
                    <i data-lucide="refresh-cw" class="w-8 h-8 text-yellow-600"></i>
                </div>
            </div>
            
            <div class="bg-purple-50 border border-purple-200 rounded-md p-4">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm text-purple-600">Overall Quality</p>
                        <p class="text-2xl font-bold text-purple-700">91.5%</p>
                    </div>
                    <i data-lucide="award" class="w-8 h-8 text-purple-600"></i>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
